# Nom du script Node.js
NODE_SCRIPT = server.js

# PID file pour stocker le processus en arriÃ¨re-plan
PID_FILE = .node_pid

# Commande pour exÃ©cuter Node.js avec redirection des logs
RUN_CMD = node $(NODE_SCRIPT) > logs.txt 2>&1 & echo $$! > $(PID_FILE)

# Lancer le serveur et stocker le PID
start:
	@echo "ğŸš€ Lancement du serveur Node.js..."
	@$(RUN_CMD)
	@sleep 1
	@echo "âœ… Serveur lancÃ© avec succÃ¨s (PID: `cat $(PID_FILE)`)."

# ArrÃªter le serveur proprement
stop:
	@if [ -f $(PID_FILE) ]; then \
		PID=`cat $(PID_FILE)`; \
		echo "ğŸ›‘ ArrÃªt du serveur (PID: $$PID)..."; \
		kill $$PID && rm -f $(PID_FILE); \
		echo "âœ… Serveur arrÃªtÃ©."; \
	else \
		echo "âŒ Aucun serveur en cours d'exÃ©cution."; \
	fi

# Afficher les logs en temps rÃ©el dans VS Code Output Panel
logs:
	@tail -f logs.txt

# Nettoyer les fichiers temporaires
clean: stop
	@rm -f $(PID_FILE) logs.txt
	@echo "ğŸ§¹ Nettoyage terminÃ©."

.PHONY: start stop logs clean
