let minX = 0;
let maxX = 0;
function init_border() {
    const borderTop = new BABYLON.MeshBuilder.CreateBox("border", {
        width: 115,
        height: 3,
        depth: 1
    }, scene);
    borderTop.position = new BABYLON.Vector3(25, 300, -72);
    borderTop.rotation = new BABYLON.Vector3(0, Math.PI / 2, 0);
    borderTop.visibility = 0;
    const borderBottom = new BABYLON.MeshBuilder.CreateBox("border", {
        width: 115,
        height: 3,
        depth: 1
    }, scene);
    borderBottom.position = new BABYLON.Vector3(-40, 300, -72);
    borderBottom.rotation = new BABYLON.Vector3(0, Math.PI / 2, 0);
    borderBottom.visibility = 0;
    minX = borderBottom.position.x + (borderBottom.scaling.x / 2) + 4.5;
    maxX = borderTop.position.x - (borderTop.scaling.x / 2) - 4.5;
}
export function init_players_tournament(scene, player_1_tournament, player_2_tournament) {
    init_border();
    player_1_tournament = new BABYLON.MeshBuilder.CreateBox("player_1_tournament", {
        width: 10,
        height: 1.5,
        depth: 1.5
    }, scene);
    player_1_tournament.position = new BABYLON.Vector3(-7, 301, -120);
    player_1_tournament.checkPaddleCollision = true;
    player_1_tournament.metadata = { isPlayer_paddle: true }; // Tag ajouté pour identifier ce mesh comme joueur
    player_1_tournament.visibility = 0;
    player_2_tournament = new BABYLON.MeshBuilder.CreateBox("player_2_tournament", {
        width: 10,
        height: 1.5,
        depth: 1.5
    }, scene);
    player_2_tournament.position = new BABYLON.Vector3(-7, 301, -24);
    player_2_tournament.checkPaddleCollision = true;
    player_2_tournament.metadata = { isPlayer_paddle: true }; // Tag ajouté pour identifier ce mesh comme joueur
    player_2_tournament.visibility = 0;
    BABYLON.SceneLoader.ImportMesh("", "/srcs/game/assets/player/", "PlayerIdleAnnimation.glb", scene, function (newMeshes) {
        const rootMesh = newMeshes.find(mesh => mesh.name === "__root__");
        if (rootMesh) {
            rootMesh.position = player_1_tournament.position.clone();
            rootMesh.scaling = new BABYLON.Vector3(6, 6, 6);
            rootMesh.rotationQuaternion = BABYLON.Quaternion.FromEulerAngles(0, Math.PI, 0);
            rootMesh.metadata = { isPlayer: true }; // Tag ajouté pour identifier ce mesh comme joueur
        }
        newMeshes.forEach(mesh => {
            if (mesh instanceof BABYLON.Mesh) {
                mesh.rotationQuaternion = null;
                mesh.rotation = new BABYLON.Vector3(Math.PI, 0, 0);
                mesh.metadata = { isPlayer: true }; // Tag ajouté pour identifier ce mesh comme joueur
            }
        });
        const playerRepere = new BABYLON.MeshBuilder.CreateBox("playerRepere", {
            width: 10,
            height: 0.1,
            depth: 1,
        }, scene);
        playerRepere.position = new BABYLON.Vector3(-7, 301, -120);
        playerRepere.material = new BABYLON.StandardMaterial("playerRepereMat", scene);
        playerRepere.material.emissiveColor = new BABYLON.Color3.Red();
        playerRepere.metadata = { isPlayerRepere: true }; // Tag ajouté pour le repère du joueur
        scene.registerBeforeRender(() => {
            rootMesh.position.x = player_1_tournament.position.x;
            rootMesh.position.y = player_1_tournament.position.y;
            rootMesh.position.z = player_1_tournament.position.z;
            playerRepere.position.x = player_1_tournament.position.x;
            playerRepere.position.y = player_1_tournament.position.y;
        });
    });
    BABYLON.SceneLoader.ImportMesh("", "/srcs/game/assets/player/", "PlayerIdleAnnimation.glb", scene, function (newMeshes) {
        const playerModel = newMeshes[0];
        playerModel.position = player_2_tournament.position.clone();
        playerModel.scaling = new BABYLON.Vector3(6, 6, 6);
        playerModel.rotation = new BABYLON.Vector3(0, Math.PI, 0);
        playerModel.metadata = { isPlayer: true }; // Tag ajouté pour le joueur 2
        const playerRepere = new BABYLON.MeshBuilder.CreateBox("playerRepere", {
            width: 10,
            height: 0.1,
            depth: 1,
        }, scene);
        playerRepere.position = new BABYLON.Vector3(-7, 301, -24.5);
        playerRepere.material = new BABYLON.StandardMaterial("playerRepereMat", scene);
        playerRepere.material.emissiveColor = new BABYLON.Color3.Red();
        playerRepere.metadata = { isPlayerRepere: true }; // Tag ajouté pour le repère du joueur 2
        // Synchronisation continue de la position
        scene.registerBeforeRender(() => {
            playerModel.position.x = player_2_tournament.position.x;
            playerModel.position.y = player_2_tournament.position.y;
            playerModel.position.z = player_2_tournament.position.z;
            playerRepere.position.x = player_2_tournament.position.x;
            playerRepere.position.y = player_2_tournament.position.y;
        });
    });
    return { player_1_tournament, player_2_tournament };
}
const paddleSpeed = 1.1;
const keys = {};
// const init_players_instance = init_players(scene);
addEventListener("keydown", (event) => keys[event.key] = true);
addEventListener("keyup", (event) => keys[event.key] = false);
export function move_player_tournament(player_1_tournament, player_2_tournament) {
    if (keys["w"] && player_1_tournament.position.x > minX) {
        player_1_tournament.position.x -= paddleSpeed;
    }
    if (keys["s"] && player_1_tournament.position.x < maxX) {
        player_1_tournament.position.x += paddleSpeed;
    }
    if (keys["i"] && player_2_tournament.position.x > minX) {
        player_2_tournament.position.x -= paddleSpeed;
    }
    if (keys["k"] && player_2_tournament.position.x < maxX) {
        player_2_tournament.position.x += paddleSpeed;
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5pdF9wbGF5ZXJfdG91cm5hbWVudC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL3B1YmxpYy9zcmNzL2dhbWUvZ2FtZXBsYXkvdG91cm5hbWVudC9pbml0X3BsYXllcl90b3VybmFtZW50LmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUNBLElBQUksSUFBSSxHQUFHLENBQUMsQ0FBQztBQUNiLElBQUksSUFBSSxHQUFHLENBQUMsQ0FBQztBQUdiLFNBQVMsV0FBVztJQUNuQixNQUFNLFNBQVMsR0FBRyxJQUFJLE9BQU8sQ0FBQyxXQUFXLENBQUMsU0FBUyxDQUFDLFFBQVEsRUFBRTtRQUM3RCxLQUFLLEVBQUUsR0FBRztRQUNWLE1BQU0sRUFBRSxDQUFDO1FBQ1QsS0FBSyxFQUFFLENBQUM7S0FDUixFQUFFLEtBQUssQ0FBQyxDQUFDO0lBQ1YsU0FBUyxDQUFDLFFBQVEsR0FBRyxJQUFJLE9BQU8sQ0FBQyxPQUFPLENBQUMsRUFBRSxFQUFFLEdBQUcsRUFBRSxDQUFDLEVBQUUsQ0FBQyxDQUFDO0lBQ3ZELFNBQVMsQ0FBQyxRQUFRLEdBQUcsSUFBSSxPQUFPLENBQUMsT0FBTyxDQUFDLENBQUMsRUFBRSxJQUFJLENBQUMsRUFBRSxHQUFHLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQztJQUM1RCxTQUFTLENBQUMsVUFBVSxHQUFHLENBQUMsQ0FBQztJQUV6QixNQUFNLFlBQVksR0FBRyxJQUFJLE9BQU8sQ0FBQyxXQUFXLENBQUMsU0FBUyxDQUFDLFFBQVEsRUFBRTtRQUNoRSxLQUFLLEVBQUUsR0FBRztRQUNWLE1BQU0sRUFBRSxDQUFDO1FBQ1QsS0FBSyxFQUFFLENBQUM7S0FDUixFQUFFLEtBQUssQ0FBQyxDQUFDO0lBQ1YsWUFBWSxDQUFDLFFBQVEsR0FBRyxJQUFJLE9BQU8sQ0FBQyxPQUFPLENBQUMsQ0FBQyxFQUFFLEVBQUUsR0FBRyxFQUFFLENBQUMsRUFBRSxDQUFDLENBQUM7SUFDM0QsWUFBWSxDQUFD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QUFDLElBQUksQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLEdBQUcsSUFBSSxDQUFDLENBQUM7QUFDL0QsZ0JBQWdCLENBQUMsT0FBTyxFQUFFLENBQUMsS0FBSyxFQUFFLEVBQUUsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxHQUFHLEtBQUssQ0FBQyxDQUFDO0FBRzlELE1BQU0sVUFBVSxzQkFBc0IsQ0FBQyxtQkFBbUIsRUFBRSxtQkFBbUI7SUFFOUUsSUFBSSxJQUFJLENBQUMsR0FBRyxDQUFDLElBQUksbUJBQW1CLENBQUMsUUFBUSxDQUFDLENBQUMsR0FBRyxJQUFJLEVBQ3RELENBQUM7UUFDQSxtQkFBbUIsQ0FBQyxRQUFRLENBQUMsQ0FBQyxJQUFJLFdBQVcsQ0FBQztJQUMvQyxDQUFDO0lBQ0QsSUFBSSxJQUFJLENBQUMsR0FBRyxDQUFDLElBQUksbUJBQW1CLENBQUMsUUFBUSxDQUFDLENBQUMsR0FBRyxJQUFJLEVBQ3RELENBQUM7UUFDQSxtQkFBbUIsQ0FBQyxRQUFRLENBQUMsQ0FBQyxJQUFJLFdBQVcsQ0FBQztJQUMvQyxDQUFDO0lBQ0QsSUFBSSxJQUFJLENBQUMsR0FBRyxDQUFDLElBQUksbUJBQW1CLENBQUMsUUFBUSxDQUFDLENBQUMsR0FBRyxJQUFJLEVBQ3RELENBQUM7UUFDQSxtQkFBbUIsQ0FBQyxRQUFRLENBQUMsQ0FBQyxJQUFJLFdBQVcsQ0FBQztJQUMvQyxDQUFDO0lBQ0QsSUFBSSxJQUFJLENBQUMsR0FBRyxDQUFDLElBQUksbUJBQW1CLENBQUMsUUFBUSxDQUFDLENBQUMsR0FBRyxJQUFJLEVBQ3RELENBQUM7UUFDQSxtQkFBbUIsQ0FBQyxRQUFRLENBQUMsQ0FBQyxJQUFJLFdBQVcsQ0FBQztJQUMvQyxDQUFDO0FBQ0YsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbIlxubGV0IG1pblggPSAwO1xubGV0IG1heFggPSAwO1xuXG5cbmZ1bmN0aW9uIGluaXRfYm9yZGVyKCkge1xuXHRjb25zdCBib3JkZXJUb3AgPSBuZXcgQkFCWUxPTi5NZXNoQnVpbGRlci5DcmVhdGVCb3goXCJib3JkZXJcIiwge1xuXHRcdHdpZHRoOiAxMTUsXG5cdFx0aGVpZ2h0OiAzLFxuXHRcdGRlcHRoOiAxXG5cdH0sIHNjZW5lKTtcblx0Ym9yZGVyVG9wLnBvc2l0aW9uID0gbmV3IEJBQllMT04uVmVjdG9yMygyNSwgMzAwLCAtNzIpO1xuXHRib3JkZXJUb3Aucm90YXRpb24gPSBuZXcgQkFCWUxPTi5WZWN0b3IzKDAsIE1hdGguUEkgLyAyLCAwKTtcblx0Ym9yZGVyVG9wLnZpc2liaWxpdHkgPSAwO1xuXHRcblx0Y29uc3QgYm9yZGVyQm90dG9tID0gbmV3IEJBQllMT04uTWVzaEJ1aWxkZXIuQ3JlYXRlQm94KFwiYm9yZGVyXCIsIHtcblx0XHR3aWR0aDogMTE1LFxuXHRcdGhlaWdodDogMyxcblx0XHRkZXB0aDogMVxuXHR9LCBzY2VuZSk7XG5cdGJvcmRlckJvdHRvbS5wb3NpdGlvbiA9IG5ldyBCQUJZTE9OLlZlY3RvcjMoLTQwLCAzMDAsIC03Mik7XG5cdGJvcmRlckJvdHRvbS5yb3RhdGlvbiA9IG5ldyBCQUJZTE9OLlZlY3RvcjMoMCwgTWF0aC5QSSAvIDIsIDApO1xuXHRib3JkZXJCb3R0b20udmlzaWJpbGl0eSA9IDA7XG5cblx0bWluWCA9IGJvcmRlckJvdHRvbS5wb3NpdGlvbi54ICsgKGJvcmRlckJvdHRvbS5zY2FsaW5nLnggLyAyKSArIDQuNTtcblx0bWF4WCA9IGJvcmRlclRvcC5wb3NpdGlvbi54IC0gKGJvcmRlclRvcC5zY2FsaW5nLnggLyAyKSAtIDQuNTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGluaXRfcGxheWVyc190b3VybmFtZW50KHNjZW5lLCBwbGF5ZXJfMV90b3VybmFtZW50LCBwbGF5ZXJfMl90b3VybmFtZW50KSB7XG5cblx0aW5pdF9ib3JkZXIoKTtcblxuXHRwbGF5ZXJfMV90b3VybmFtZW50ID0gbmV3IEJBQllMT04uTWVzaEJ1aWxkZXIuQ3JlYXRlQm94KFwicGxheWVyXzFfdG91cm5hbWVudFwiLCB7XG5cdFx0d2lkdGg6IDEwLFxuXHRcdGhlaWdodDogMS41LFxuXHRcdGRlcHRoOiAxLjVcblx0fSwgc2NlbmUpO1xuXHRwbGF5ZXJfMV90b3VybmFtZW50LnBvc2l0aW9uID0gbmV3IEJBQllMT04uVmVjdG9yMygtNywgMzAxLCAtMTIwKTtcblx0cGxheWVyXzFfdG91cm5hbWVudC5jaGVja1BhZGRsZUNvbGxpc2lvbiA9IHRydWU7XG5cdHBsYXllcl8xX3RvdXJuYW1lbnQubWV0YWRhdGEgPSB7IGlzUGxheWVyX3BhZGRsZTogdHJ1ZSB9OyAgLy8gVGFnIGFqb3V0w6kgcG91ciBpZGVudGlmaWVyIGNlIG1lc2ggY29tbWUgam91ZXVyXG5cdHBsYXllcl8xX3RvdXJuYW1lbnQudmlzaWJpbGl0eSA9IDA7XG5cdFxuXHRwbGF5ZXJfMl90b3VybmFtZW50ID0gbmV3IEJBQllMT04uTWVzaEJ1aWxkZXIuQ3JlYXRlQm94KFwicGxheWVyXzJfdG91cm5hbWVudFwiLCB7XG5cdFx0d2lkdGg6IDEwLFxuXHRcdGhlaWdodDogMS41LFxuXHRcdGRlcHRoOiAxLjVcblx0fSwgc2NlbmUpO1xuXHRwbGF5ZXJfMl90b3VybmFtZW50LnBvc2l0aW9uID0gbmV3IEJBQllMT04uVmVjdG9yMygtNywgMzAxLCAtMjQpO1xuXHRwbGF5ZXJfMl90b3VybmFtZW50LmNoZWNrUGFkZGxlQ29sbGlzaW9uID0gdHJ1ZTtcblx0cGxheWVyXzJfdG91cm5hbWVudC5tZXRhZGF0YSA9IHsgaXNQbGF5ZXJfcGFkZGxlOiB0cnVlIH07ICAvLyBUYWcgYWpvdXTDqSBwb3VyIGlkZW50aWZpZXIgY2UgbWVzaCBjb21tZSBqb3VldXJcblx0cGxheWVyXzJfdG91cm5hbWVudC52aXNpYmlsaXR5ID0gMDtcblxuXHRCQUJZTE9OLlNjZW5lTG9hZGVyLkltcG9ydE1lc2goXCJcIiwgXCIvc3Jjcy9nYW1lL2Fzc2V0cy9wbGF5ZXIvXCIsIFwiUGxheWVySWRsZUFubmltYXRpb24uZ2xiXCIsIHNjZW5lLCBmdW5jdGlvbiAobmV3TWVzaGVzKSB7XG5cdFx0Y29uc3Qgcm9vdE1lc2ggPSBuZXdNZXNoZXMuZmluZChtZXNoID0+IG1lc2gubmFtZSA9PT0gXCJfX3Jvb3RfX1wiKTtcblx0XHRpZiAocm9vdE1lc2gpIHtcblx0XHRcdHJvb3RNZXNoLnBvc2l0aW9uID0gcGxheWVyXzFfdG91cm5hbWVudC5wb3NpdGlvbi5jbG9uZSgpO1xuXHRcdFx0cm9vdE1lc2guc2NhbGluZyA9IG5ldyBCQUJZTE9OLlZlY3RvcjMoNiwgNiwgNik7XG5cdFx0XHRyb290TWVzaC5yb3RhdGlvblF1YXRlcm5pb24gPSBCQUJZTE9OLlF1YXRlcm5pb24uRnJvbUV1bGVyQW5nbGVzKDAsIE1hdGguUEksIDApO1xuXHRcdFx0cm9vdE1lc2gubWV0YWRhdGEgPSB7IGlzUGxheWVyOiB0cnVlIH07ICAvLyBUYWcgYWpvdXTDqSBwb3VyIGlkZW50aWZpZXIgY2UgbWVzaCBjb21tZSBqb3VldXJcblx0XHR9XG5cdFxuXHRcdG5ld01lc2hlcy5mb3JFYWNoKG1lc2ggPT4ge1xuXHRcdFx0aWYgKG1lc2ggaW5zdGFuY2VvZiBCQUJZTE9OLk1lc2gpIHtcblx0XHRcdFx0bWVzaC5yb3RhdGlvblF1YXRlcm5pb24gPSBudWxsO1xuXHRcdFx0XHRtZXNoLnJvdGF0aW9uID0gbmV3IEJBQllMT04uVmVjdG9yMyhNYXRoLlBJLCAwLCAwKTtcblx0XHRcdFx0bWVzaC5tZXRhZGF0YSA9IHsgaXNQbGF5ZXI6IHRydWUgfTsgIC8vIFRhZyBham91dMOpIHBvdXIgaWRlbnRpZmllciBjZSBtZXNoIGNvbW1lIGpvdWV1clxuXHRcdFx0fVxuXHRcdH0pO1xuXHRcblx0XHRjb25zdCBwbGF5ZXJSZXBlcmUgPSBuZXcgQkFCWUxPTi5NZXNoQnVpbGRlci5DcmVhdGVCb3goXCJwbGF5ZXJSZXBlcmVcIiwge1xuXHRcdFx0d2lkdGg6IDEwLFxuXHRcdFx0aGVpZ2h0OiAwLjEsXG5cdFx0XHRkZXB0aDogMSxcblx0XHR9LCBzY2VuZSk7XG5cdFx0cGxheWVyUmVwZXJlLnBvc2l0aW9uID0gbmV3IEJBQllMT04uVmVjdG9yMygtNywgMzAxLCAtMTIwKTtcblx0XHRwbGF5ZXJSZXBlcmUubWF0ZXJpYWwgPSBuZXcgQkFCWUxPTi5TdGFuZGFyZE1hdGVyaWFsKFwicGxheWVyUmVwZXJlTWF0XCIsIHNjZW5lKTtcblx0XHRwbGF5ZXJSZXBlcmUubWF0ZXJpYWwuZW1pc3NpdmVDb2xvciA9IG5ldyBCQUJZTE9OLkNvbG9yMy5SZWQoKTtcblx0XHRwbGF5ZXJSZXBlcmUubWV0YWRhdGEgPSB7IGlzUGxheWVyUmVwZXJlOiB0cnVlIH07ICAvLyBUYWcgYWpvdXTDqSBwb3VyIGxlIHJlcMOocmUgZHUgam91ZXVyXG5cdFxuXHRcdHNjZW5lLnJlZ2lzdGVyQmVmb3JlUmVuZGVyKCgpID0+IHtcblx0XHRcdHJvb3RNZXNoLnBvc2l0aW9uLnggPSBwbGF5ZXJfMV90b3VybmFtZW50LnBvc2l0aW9uLng7XG5cdFx0XHRyb290TWVzaC5wb3NpdGlvbi55ID0gcGxheWVyXzFfdG91cm5hbWVudC5wb3NpdGlvbi55O1xuXHRcdFx0cm9vdE1lc2gucG9zaXRpb24ueiA9IHBsYXllcl8xX3RvdXJuYW1lbnQucG9zaXRpb24uejtcblx0XHRcdHBsYXllclJlcGVyZS5wb3NpdGlvbi54ID0gcGxheWVyXzFfdG91cm5hbWVudC5wb3NpdGlvbi54O1xuXHRcdFx0cGxheWVyUmVwZXJlLnBvc2l0aW9uLnkgPSBwbGF5ZXJfMV90b3VybmFtZW50LnBvc2l0aW9uLnk7XG5cdFx0fSk7XG5cdH0pO1xuXG5cdEJBQllMT04uU2NlbmVMb2FkZXIuSW1wb3J0TWVzaChcIlwiLCBcIi9zcmNzL2dhbWUvYXNzZXRzL3BsYXllci9cIiwgXCJQbGF5ZXJJZGxlQW5uaW1hdGlvbi5nbGJcIiwgc2NlbmUsIGZ1bmN0aW9uIChuZXdNZXNoZXMpIHtcblx0XHRjb25zdCBwbGF5ZXJNb2RlbCA9IG5ld01lc2hlc1swXTtcblx0XHRwbGF5ZXJNb2RlbC5wb3NpdGlvbiA9IHBsYXllcl8yX3RvdXJuYW1lbnQucG9zaXRpb24uY2xvbmUoKTtcblx0XHRwbGF5ZXJNb2RlbC5zY2FsaW5nID0gbmV3IEJBQllMT04uVmVjdG9yMyg2LCA2LCA2KTtcblx0XHRwbGF5ZXJNb2RlbC5yb3RhdGlvbiA9IG5ldyBCQUJZTE9OLlZlY3RvcjMoMCwgTWF0aC5QSSwgMCk7XG5cdFx0cGxheWVyTW9kZWwubWV0YWRhdGEgPSB7IGlzUGxheWVyOiB0cnVlIH07ICAvLyBUYWcgYWpvdXTDqSBwb3VyIGxlIGpvdWV1ciAyXG5cdFxuXHRcdGNvbnN0IHBsYXllclJlcGVyZSA9IG5ldyBCQUJZTE9OLk1lc2hCdWlsZGVyLkNyZWF0ZUJveChcInBsYXllclJlcGVyZVwiLCB7XG5cdFx0XHR3aWR0aDogMTAsXG5cdFx0XHRoZWlnaHQ6IDAuMSxcblx0XHRcdGRlcHRoOiAxLFxuXHRcdH0sIHNjZW5lKTtcblx0XHRwbGF5ZXJSZXBlcmUucG9zaXRpb24gPSBuZXcgQkFCWUxPTi5WZWN0b3IzKC03LCAzMDEsIC0yNC41KTtcblx0XHRwbGF5ZXJSZXBlcmUubWF0ZXJpYWwgPSBuZXcgQkFCWUxPTi5TdGFuZGFyZE1hdGVyaWFsKFwicGxheWVyUmVwZXJlTWF0XCIsIHNjZW5lKTtcblx0XHRwbGF5ZXJSZXBlcmUubWF0ZXJpYWwuZW1pc3NpdmVDb2xvciA9IG5ldyBCQUJZTE9OLkNvbG9yMy5SZWQoKTtcblx0XHRwbGF5ZXJSZXBlcmUubWV0YWRhdGEgPSB7IGlzUGxheWVyUmVwZXJlOiB0cnVlIH07ICAvLyBUYWcgYWpvdXTDqSBwb3VyIGxlIHJlcMOocmUgZHUgam91ZXVyIDJcblx0XG5cdFx0Ly8gU3luY2hyb25pc2F0aW9uIGNvbnRpbnVlIGRlIGxhIHBvc2l0aW9uXG5cdFx0c2NlbmUucmVnaXN0ZXJCZWZvcmVSZW5kZXIoKCkgPT4ge1xuXHRcdFx0cGxheWVyTW9kZWwucG9zaXRpb24ueCA9IHBsYXllcl8yX3RvdXJuYW1lbnQucG9zaXRpb24ueDtcblx0XHRcdHBsYXllck1vZGVsLnBvc2l0aW9uLnkgPSBwbGF5ZXJfMl90b3VybmFtZW50LnBvc2l0aW9uLnk7XG5cdFx0XHRwbGF5ZXJNb2RlbC5wb3NpdGlvbi56ID0gcGxheWVyXzJfdG91cm5hbWVudC5wb3NpdGlvbi56O1xuXHRcdFx0cGxheWVyUmVwZXJlLnBvc2l0aW9uLnggPSBwbGF5ZXJfMl90b3VybmFtZW50LnBvc2l0aW9uLng7XG5cdFx0XHRwbGF5ZXJSZXBlcmUucG9zaXRpb24ueSA9IHBsYXllcl8yX3RvdXJuYW1lbnQucG9zaXRpb24ueTtcblx0XHR9KTtcblx0fSk7XG5cblx0cmV0dXJuIHsgcGxheWVyXzFfdG91cm5hbWVudCwgcGxheWVyXzJfdG91cm5hbWVudCB9O1xufVxuXG5cblxuXG5jb25zdCBwYWRkbGVTcGVlZCA9IDEuMTtcbmNvbnN0IGtleXMgPSB7fTsgXG4vLyBjb25zdCBpbml0X3BsYXllcnNfaW5zdGFuY2UgPSBpbml0X3BsYXllcnMoc2NlbmUpO1xuXG5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCAoZXZlbnQpID0+IGtleXNbZXZlbnQua2V5XSA9IHRydWUpO1xuYWRkRXZlbnRMaXN0ZW5lcihcImtleXVwXCIsIChldmVudCkgPT4ga2V5c1tldmVudC5rZXldID0gZmFsc2UpO1xuXG5cbmV4cG9ydCBmdW5jdGlvbiBtb3ZlX3BsYXllcl90b3VybmFtZW50KHBsYXllcl8xX3RvdXJuYW1lbnQsIHBsYXllcl8yX3RvdXJuYW1lbnQpXG57XG5cdGlmIChrZXlzW1wid1wiXSAmJiBwbGF5ZXJfMV90b3VybmFtZW50LnBvc2l0aW9uLnggPiBtaW5YKVxuXHR7XG5cdFx0cGxheWVyXzFfdG91cm5hbWVudC5wb3NpdGlvbi54IC09IHBhZGRsZVNwZWVkO1xuXHR9XG5cdGlmIChrZXlzW1wic1wiXSAmJiBwbGF5ZXJfMV90b3VybmFtZW50LnBvc2l0aW9uLnggPCBtYXhYKVxuXHR7XG5cdFx0cGxheWVyXzFfdG91cm5hbWVudC5wb3NpdGlvbi54ICs9IHBhZGRsZVNwZWVkO1xuXHR9XG5cdGlmIChrZXlzW1wiaVwiXSAmJiBwbGF5ZXJfMl90b3VybmFtZW50LnBvc2l0aW9uLnggPiBtaW5YKVxuXHR7XG5cdFx0cGxheWVyXzJfdG91cm5hbWVudC5wb3NpdGlvbi54IC09IHBhZGRsZVNwZWVkO1xuXHR9XG5cdGlmIChrZXlzW1wia1wiXSAmJiBwbGF5ZXJfMl90b3VybmFtZW50LnBvc2l0aW9uLnggPCBtYXhYKVxuXHR7XG5cdFx0cGxheWVyXzJfdG91cm5hbWVudC5wb3NpdGlvbi54ICs9IHBhZGRsZVNwZWVkO1xuXHR9XG59Il19